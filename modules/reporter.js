<<<<<<< HEAD
/*  
Tools Dibuat Oleh 
Developer : Xbibz Official 
Tiktok : tiktok.com/@xbibzofficiall 
Youtube : Xbibz Official
*/







const _0x15a5cf=_0x1b39;(function(_0x59d9a5,_0x5cfe71){const _0x5a57c6=_0x1b39,_0x58b622=_0x59d9a5();while(!![]){try{const _0x46bc49=-parseInt(_0x5a57c6(0x1c0))/(-0xbfd*-0x3+-0x629*0x2+0xb2*-0x22)+-parseInt(_0x5a57c6(0x22e))/(-0x21b0+0x9*-0x27+0x2311)*(-parseInt(_0x5a57c6(0x1d8))/(0x22f+0x1304*-0x2+0x23dc))+-parseInt(_0x5a57c6(0x22b))/(-0x22f2+-0xf89+-0x10d5*-0x3)*(-parseInt(_0x5a57c6(0x210))/(0x1746+0x9f1+-0x2132))+-parseInt(_0x5a57c6(0x1ff))/(0x1cf*-0x13+-0x37*-0x30+0x1813*0x1)*(parseInt(_0x5a57c6(0x22a))/(-0x12ee+0x394*0x8+0x9ab*-0x1))+parseInt(_0x5a57c6(0x20a))/(0x24b8+0x1cc6+-0x4176)*(parseInt(_0x5a57c6(0x223))/(-0x8ed+0xd25*0x2+-0x1154))+-parseInt(_0x5a57c6(0x208))/(-0x1305+0x1d*-0x141+0x376c)+-parseInt(_0x5a57c6(0x1e2))/(-0x1cf*0xb+-0x1d7+0xdf*0x19)*(-parseInt(_0x5a57c6(0x1ed))/(-0x30a*0x4+-0x6f*0x17+0x32b*0x7));if(_0x46bc49===_0x5cfe71)break;else _0x58b622['push'](_0x58b622['shift']());}catch(_0xc6b524){_0x58b622['push'](_0x58b622['shift']());}}}(_0x356f,-0x6d2fe+0x7*-0x104f+0xd7847));const _0x4b2c8b=(function(){const _0x543cd8={'yAgxT':function(_0x3a844b,_0x3feeef){return _0x3a844b===_0x3feeef;}};let _0x56e48a=!![];return function(_0x42ef70,_0x2518f1){const _0x2fa285=_0x1b39,_0x1b55be={'CsScc':function(_0xf1411e,_0x283d54){const _0x5a270e=_0x1b39;return _0x543cd8[_0x5a270e(0x1d7)](_0xf1411e,_0x283d54);},'QngWy':_0x2fa285(0x1f8)},_0x1106aa=_0x56e48a?function(){const _0x315b21=_0x2fa285,_0x181fcd={'Yesri':_0x315b21(0x1ce)+_0x315b21(0x220)+_0x315b21(0x1c9)+'ntuk\x20'+'mengi'+_0x315b21(0x219)+_0x315b21(0x1e0)+'ikan\x20'+_0x315b21(0x22d)};if(_0x1b55be[_0x315b21(0x231)](_0x1b55be[_0x315b21(0x20d)],_0x315b21(0x221)))_0xc5e1a4[_0x315b21(0x1b7)](_0x181fcd['Yesri']);else{if(_0x2518f1){const _0x5095d6=_0x2518f1[_0x315b21(0x1cd)](_0x42ef70,arguments);return _0x2518f1=null,_0x5095d6;}}}:function(){};return _0x56e48a=![],_0x1106aa;};}()),_0x3d2c3e=_0x4b2c8b(this,function(){const _0x1fc4f1=_0x1b39,_0x2a0c2c={'ebGcR':_0x1fc4f1(0x1cf)+_0x1fc4f1(0x1f7)+'+$'};return _0x3d2c3e[_0x1fc4f1(0x200)+_0x1fc4f1(0x1f4)]()[_0x1fc4f1(0x1f3)+'h'](_0x2a0c2c['ebGcR'])[_0x1fc4f1(0x200)+_0x1fc4f1(0x1f4)]()[_0x1fc4f1(0x234)+_0x1fc4f1(0x1f1)+'r'](_0x3d2c3e)['searc'+'h'](_0x2a0c2c[_0x1fc4f1(0x1d3)]);});_0x3d2c3e();import _0x2abe91 from'chalk';import _0x5936c6 from'fs';import _0x2c8896 from'path';function _0x1b39(_0x16599e,_0x497a9c){const _0xe73c41=_0x356f();return _0x1b39=function(_0x3cce37,_0x12b019){_0x3cce37=_0x3cce37-(0x132b+0x595*0x3+-0x55*0x67);let _0x141f9d=_0xe73c41[_0x3cce37];if(_0x1b39['rHDiFq']===undefined){var _0x555725=function(_0x1372ce){const _0x483d8a='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x164ed2='',_0x4bc8b1='',_0x28afe8=_0x164ed2+_0x555725;for(let _0x76dd57=-0x26ba+-0x1976+0x4030,_0xe8678f,_0x390a25,_0x31919f=-0x2489*0x1+-0xdc9*-0x1+-0xd*-0x1c0;_0x390a25=_0x1372ce['charAt'](_0x31919f++);~_0x390a25&&(_0xe8678f=_0x76dd57%(-0x1468+0x79e*0x2+0x53*0x10)?_0xe8678f*(-0xcc+-0x8ae+0x4dd*0x2)+_0x390a25:_0x390a25,_0x76dd57++%(0x25*0x53+0x11*0x169+-0x23f4))?_0x164ed2+=_0x28afe8['charCodeAt'](_0x31919f+(-0x53*0x1a+0x1*-0x183f+0x20b7))-(0xfd2+-0x1*-0xf7c+-0x1f44)!==-0x8b+0x3f3+-0x368?String['fromCharCode'](0x2229+0x18*-0x74+-0x9*0x27a&_0xe8678f>>(-(0xfca+0x1*-0x1bcd+0xc05)*_0x76dd57&0x145a+-0xc*0x31a+0x5e*0x2e)):_0x76dd57:-0x1b8e+-0xb*-0x32b+-0x74b){_0x390a25=_0x483d8a['indexOf'](_0x390a25);}for(let _0x436384=-0x2*-0x1052+0xc*0x76+-0x4*0x98b,_0x19c664=_0x164ed2['length'];_0x436384<_0x19c664;_0x436384++){_0x4bc8b1+='%'+('00'+_0x164ed2['charCodeAt'](_0x436384)['toString'](-0x2655+-0x1a32+0x4097))['slice'](-(-0x1*-0xd79+0x1020+0x5eb*-0x5));}return decodeURIComponent(_0x4bc8b1);};_0x1b39['HPACfP']=_0x555725,_0x16599e=arguments,_0x1b39['rHDiFq']=!![];}const _0x5eb07f=_0xe73c41[-0x62b+0x9*0x317+-0x15a4*0x1],_0x4a3808=_0x3cce37+_0x5eb07f,_0x276616=_0x16599e[_0x4a3808];if(!_0x276616){const _0xfb8484=function(_0x48f4e6){this['WkkYAW']=_0x48f4e6,this['kKDrNZ']=[-0x20f3*-0x1+-0x21b*-0x11+-0x44bd*0x1,-0x1ca3+-0x17*-0x9e+0xe71*0x1,0x1894+0x248b+-0x3d1f],this['Zvjwxy']=function(){return'newState';},this['Ecvkbf']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['DtrFZF']='[\x27|\x22].+[\x27|\x22];?\x20*}';};_0xfb8484['prototype']['eHdnQg']=function(){const _0x22d36b=new RegExp(this['Ecvkbf']+this['DtrFZF']),_0x246e55=_0x22d36b['test'](this['Zvjwxy']['toString']())?--this['kKDrNZ'][-0x1cf0+-0x43e*-0x6+0x2f*0x13]:--this['kKDrNZ'][-0x38*0x2b+0x2084+-0x33*0x74];return this['UWMAox'](_0x246e55);},_0xfb8484['prototype']['UWMAox']=function(_0x24d71e){if(!Boolean(~_0x24d71e))return _0x24d71e;return this['EKjdtS'](this['WkkYAW']);},_0xfb8484['prototype']['EKjdtS']=function(_0x19950f){for(let _0x659f52=-0x8dd+-0x8a9*-0x3+-0x88f*0x2,_0x27fd38=this['kKDrNZ']['length'];_0x659f52<_0x27fd38;_0x659f52++){this['kKDrNZ']['push'](Math['round'](Math['random']())),_0x27fd38=this['kKDrNZ']['length'];}return _0x19950f(this['kKDrNZ'][-0x27*0x81+0x2316+-0xf6f]);},new _0xfb8484(_0x1b39)['eHdnQg'](),_0x141f9d=_0x1b39['HPACfP'](_0x141f9d),_0x16599e[_0x4a3808]=_0x141f9d;}else _0x141f9d=_0x276616;return _0x141f9d;},_0x1b39(_0x16599e,_0x497a9c);}import{fileURLToPath}from'url';const __filename=fileURLToPath(import.meta[_0x15a5cf(0x1f5)]),__dirname=_0x2c8896[_0x15a5cf(0x224)+'me'](__filename);function _0x356f(){const _0x51a546=['BxvHigy','uhvpzuW','zwjhy1i','yxnHBIa','tcbjBMO','u3nRD0K','EufNEfq','mtaYuunuu3PA','Cvn4t3u','BwfNzw4','yxqGChi','zwn1CMK','zMvUz1q','y2fS','Bg9N','zw50yxm','yw4GChi','mtfZyKvxA0e','DhmGDw4','yNvNqM8','r3vUywS','DhLWzq','BwvTyNu','D3jPDgu','zxbHCMu','Au5ZDhu','y3LHBG','CMvK','mtKZmZeXnKzHqvnkta','zZOG','z3jLzw4','zMLSDgu','CNvJDg8','Dg9ju08','C2vHCMm','Aw5N','DxjS','DhvRig0','ksSPkYK','vLzSz0e','cLSJxsa','z2LMEq','sunrt0m','uMLUz2S','C3vTBwe','EwvSBg8','mtjvyMf5rNK','Dg9tDhi','CMvWB3i','kentucK','Aw9U','thziuxe','BNr1AYa','BwTKAxi','Bg93','mZK1mty5meL0r0zfuq','vNvSBMu','ofnMtvHcvq','BMPLy3q','BxbHBIa','uw5Nv3K','BML0yxm','BNrHBMe','mty1BvjvwgvJ','u3LUyW','vvPpDMS','zxHPC3q','s3jPDgK','Cg9Yyw4','Cg9YDhm','DNvSBMu','BgLJEsa','BxbSzw0','CZOG','zw5JzwC','C1n5BMm','rw1OA24','DhKGug8','DxqGCge','BwjHBMC','ChvsAKG','tgfRDwS','nJiYmti0mvrAq0fJvG','zgLYBMe','yvznve0','u1fmieK','vg90ywW','ywGGu1e','AxrPzxm','mty1ndKZm1f6EMLetG','ndiWmdrcwwPUrfi','C2LRyw4','v0fg','otiYnfncrgLYDW','BgvUz3q','wfnt','q3nty2m','u3rYAw4','C3rYAw4','y29UC3q','C29Tzq','zw50ifm','B3jT','ChvZAa','lI4VCMu','DvPICuC','y2HiA2S','BKXIrhe','AM9PBG','BJOG','BgnpEgq','cLVdSmw44Ocz','odeZnZjjDgnrvMK','CMfIAwW','D2fM','qM91BNq','A3L5qvu','AdOG','ieTLCMu','uMvUzge','CMvWBge','A2fUihu','wKTrzha','zwn0Aw8','BwvUz2K','yxbWBhK','ugvYDgK','kcGOlIS','WR5DieXH'];_0x356f=function(){return _0x51a546;};return _0x356f();}export async function generateReport(_0x4d826f){const _0x520da0=_0x15a5cf,_0x36c622={'kyyAU':function(_0x157c18,_0x381791){return _0x157c18(_0x381791);},'MOaIj':_0x520da0(0x1f9)+_0x520da0(0x1fc)+_0x520da0(0x1d4)+'Hasil'+':'},_0x5ee0c2=_0x2c8896[_0x520da0(0x1bc)](__dirname,_0x520da0(0x1b8)+_0x520da0(0x216));!_0x5936c6[_0x520da0(0x213)+_0x520da0(0x21c)](_0x5ee0c2)&&_0x5936c6[_0x520da0(0x206)+_0x520da0(0x211)](_0x5ee0c2);const _0x1510e1=new Date()[_0x520da0(0x1f2)+_0x520da0(0x232)+'g']()[_0x520da0(0x1c8)+'ce'](/[:.]/g,'-'),_0xc92ef2='scan-'+_0x520da0(0x201)+'t-'+_0x1510e1+'.json',_0x16efa2=_0x2c8896[_0x520da0(0x1bc)](_0x5ee0c2,_0xc92ef2),_0x479d26={..._0x4d826f,'summary':{'totalVulnerabilities':_0x4d826f[_0x520da0(0x217)+_0x520da0(0x1c1)+_0x520da0(0x229)]['lengt'+'h'],'critical':_0x4d826f[_0x520da0(0x217)+_0x520da0(0x1c1)+'ities'][_0x520da0(0x1f0)+'r'](_0x3ed021=>_0x3ed021['type']===_0x520da0(0x226)+'nject'+_0x520da0(0x203))[_0x520da0(0x22f)+'h'],'medium':_0x4d826f['vulne'+_0x520da0(0x1c1)+_0x520da0(0x229)][_0x520da0(0x1f0)+'r'](_0x5a5c56=>_0x5a5c56[_0x520da0(0x1e6)]===_0x520da0(0x230))[_0x520da0(0x22f)+'h'],'low':_0x4d826f[_0x520da0(0x217)+'rabil'+_0x520da0(0x229)][_0x520da0(0x1f0)+'r'](_0x23cb93=>_0x23cb93[_0x520da0(0x1e6)]==='Other')[_0x520da0(0x22f)+'h']},'recommendations':_0x36c622[_0x520da0(0x1c4)](generateRecommendations,_0x4d826f)};_0x5936c6[_0x520da0(0x1e8)+'FileS'+'ync'](_0x16efa2,JSON[_0x520da0(0x233)+_0x520da0(0x1fa)](_0x479d26,null,-0x1*-0x1405+-0x104b*0x1+-0x3b8)),console[_0x520da0(0x1df)](_0x2abe91[_0x520da0(0x1da)+'ta'](_0x36c622['MOaIj'])),console[_0x520da0(0x1df)](_0x520da0(0x227)+_0x520da0(0x1c6)+_0x520da0(0x20f)+_0x520da0(0x1bd)+_0x2abe91[_0x520da0(0x1ec)](_0x479d26['summa'+'ry']['total'+_0x520da0(0x209)+_0x520da0(0x1c1)+_0x520da0(0x229)])),console['log'](_0x520da0(0x214)+_0x520da0(0x21a)+_0x2abe91[_0x520da0(0x1ec)](_0x479d26['summa'+'ry']['criti'+_0x520da0(0x1de)])),console[_0x520da0(0x1df)]('Sedan'+_0x520da0(0x1ee)+_0x2abe91[_0x520da0(0x1fe)+'w'](_0x479d26[_0x520da0(0x1fd)+'ry']['mediu'+'m'])),console['log'](_0x520da0(0x1c7)+_0x520da0(0x1c5)+_0x2abe91[_0x520da0(0x1ef)](_0x479d26[_0x520da0(0x1fd)+'ry'][_0x520da0(0x207)])),console[_0x520da0(0x1df)](_0x2abe91[_0x520da0(0x1eb)](_0x520da0(0x1bf)+_0x520da0(0x1d0)+_0x520da0(0x215)+'\x20disi'+_0x520da0(0x20c)+'di:\x20'+_0x16efa2));}function generateRecommendations(_0x3025a3){const _0x557b9a=_0x15a5cf,_0xd20a7b={'LvHQq':'Imple'+'menta'+_0x557b9a(0x22c)+'\x20Cont'+_0x557b9a(0x236)+_0x557b9a(0x1dc)+_0x557b9a(0x21e)+_0x557b9a(0x218)+_0x557b9a(0x202),'nLbDq':_0x557b9a(0x222)+'an\x20sa'+_0x557b9a(0x20e)+'i\x20inp'+_0x557b9a(0x21f)+'da\x20se'+_0x557b9a(0x1d1)+_0x557b9a(0x237),'fengT':function(_0x17ac20,_0x369a71){return _0x17ac20!==_0x369a71;},'HchiC':_0x557b9a(0x1ba),'aVMTM':_0x557b9a(0x212),'thhPD':_0x557b9a(0x1e5)+_0x557b9a(0x1e1)+_0x557b9a(0x1e9)+'d\x20sta'+'temen'+_0x557b9a(0x1e3)+_0x557b9a(0x1f6)+_0x557b9a(0x21b)+_0x557b9a(0x228)+_0x557b9a(0x1d5)+_0x557b9a(0x1cb)+'n','ICQOC':function(_0x547f61,_0x5e1ba7){return _0x547f61===_0x5e1ba7;},'Emhkn':'hFBKo','lcOxd':_0x557b9a(0x1ea),'uZbqG':_0x557b9a(0x1ce)+_0x557b9a(0x220)+'kan\x20u'+'ntuk\x20'+_0x557b9a(0x1cc)+_0x557b9a(0x219)+_0x557b9a(0x1e0)+'ikan\x20'+_0x557b9a(0x22d),'SskwI':_0x557b9a(0x1d9),'ZKQdp':_0x557b9a(0x1ce)+'mbang'+_0x557b9a(0x1c9)+_0x557b9a(0x205)+_0x557b9a(0x1e7)+_0x557b9a(0x1db)+'ogram'+'\x20Bug\x20'+_0x557b9a(0x1c3)+'y'},_0x3a5130=[];if(_0x3025a3[_0x557b9a(0x217)+_0x557b9a(0x1c1)+_0x557b9a(0x229)][_0x557b9a(0x235)](_0x93c034=>_0x93c034[_0x557b9a(0x1e6)]===_0x557b9a(0x226)+_0x557b9a(0x20b)+_0x557b9a(0x203))){if(_0xd20a7b[_0x557b9a(0x1dd)](_0xd20a7b['HchiC'],_0xd20a7b[_0x557b9a(0x225)]))_0x3a5130[_0x557b9a(0x1b7)](_0xd20a7b['thhPD']);else{if(_0x39542f){const _0x1958cd=_0x4b0943[_0x557b9a(0x1cd)](_0x123cd6,arguments);return _0x4ff4e1=null,_0x1958cd;}}}_0x3025a3[_0x557b9a(0x217)+_0x557b9a(0x1c1)+'ities'][_0x557b9a(0x235)](_0xd495b7=>_0xd495b7[_0x557b9a(0x1e6)]===_0x557b9a(0x230))&&(_0x3a5130[_0x557b9a(0x1b7)](_0xd20a7b[_0x557b9a(0x204)]),_0x3a5130['push'](_0xd20a7b[_0x557b9a(0x1bb)]));(!_0x3025a3[_0x557b9a(0x1c2)]||_0xd20a7b[_0x557b9a(0x1fb)](_0x3025a3[_0x557b9a(0x1c2)][_0x557b9a(0x22f)+'h'],0x879*0x1+0x15e7+0x9*-0x360))&&(_0xd20a7b[_0x557b9a(0x1dd)](_0xd20a7b[_0x557b9a(0x21d)],_0xd20a7b[_0x557b9a(0x1be)])?_0x3a5130[_0x557b9a(0x1b7)](_0xd20a7b[_0x557b9a(0x1b9)]):(_0x1904f8['push'](_0xd20a7b[_0x557b9a(0x204)]),_0x5766b4[_0x557b9a(0x1b7)](_0xd20a7b[_0x557b9a(0x1bb)])));if(!_0x3025a3[_0x557b9a(0x1e4)+'unty']){if(_0xd20a7b[_0x557b9a(0x1d6)]!==_0x557b9a(0x1d2))_0x3a5130['push'](_0xd20a7b[_0x557b9a(0x1ca)]);else{const _0xc0e04e=_0x265b7d?function(){if(_0x5afad4){const _0x2b4601=_0x8fc982['apply'](_0x2dfac1,arguments);return _0x4c98fd=null,_0x2b4601;}}:function(){};return _0x5db9df=![],_0xc0e04e;}}return _0x3a5130;}
=======
import chalk from 'chalk';
import fs from 'fs';
import path from 'path';
import { fileURLToPath } from 'url';

const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);

export async function generateReport(results) {
  const reportDir = path.join(__dirname, '../reports');
  
  if (!fs.existsSync(reportDir)) {
    fs.mkdirSync(reportDir);
  }
  
  const timestamp = new Date().toISOString().replace(/[:.]/g, '-');
  const filename = `scan-report-${timestamp}.json`;
  const filepath = path.join(reportDir, filename);
  
  // Create detailed report
  const report = {
    ...results,
    summary: {
      totalVulnerabilities: results.vulnerabilities.length,
      critical: results.vulnerabilities.filter(v => v.type === 'SQL Injection').length,
      medium: results.vulnerabilities.filter(v => v.type === 'XSS').length,
      low: results.vulnerabilities.filter(v => v.type === 'Other').length
    },
    recommendations: generateRecommendations(results)
  };
  
  fs.writeFileSync(filepath, JSON.stringify(report, null, 2));
  
  // Display summary
  console.log(chalk.magenta('\n[ðŸ“Š] Ringkasan Hasil:'));
  console.log(`Total Kerentanan: ${chalk.red(report.summary.totalVulnerabilities)}`);
  console.log(`Kritis: ${chalk.red(report.summary.critical)}`);
  console.log(`Sedang: ${chalk.yellow(report.summary.medium)}`);
  console.log(`Rendah: ${chalk.green(report.summary.low)}`);
  
  console.log(chalk.cyan(`\n[ðŸ’¾] Laporan disimpan di: ${filepath}`));
}

function generateRecommendations(results) {
  const recommendations = [];
  
  if (results.vulnerabilities.some(v => v.type === 'SQL Injection')) {
    recommendations.push('Gunakan prepared statements untuk mencegah SQL Injection');
  }
  
  if (results.vulnerabilities.some(v => v.type === 'XSS')) {
    recommendations.push('Implementasikan Content Security Policy (CSP)');
    recommendations.push('Lakukan sanitasi input pada semua form');
  }
  
  if (!results.waf || results.waf.length === 0) {
    recommendations.push('Pertimbangkan untuk mengimplementasikan WAF');
  }
  
  if (!results.bugBounty) {
    recommendations.push('Pertimbangkan untuk membuat program Bug Bounty');
  }
  
  return recommendations;
}
>>>>>>> origin/main
